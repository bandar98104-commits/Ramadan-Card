<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø±ÙˆØ¨ÙˆØª ÙˆØ§Ù„Ø±ÙŠØ§Ø¶Ø§Øª</title>

  <!-- âœ… ØªØ­Ù…ÙŠÙ„ Ø®Ø· Ø£Ù…ÙŠØ±ÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ -->
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: "Amiri", serif;
      text-align: center;
      background: #f2f2f2;
      padding: 20px;
    }

    h2 {
      margin-bottom: 20px;
    }

    input, textarea {
      width: 80%;
      padding: 12px;
      margin: 10px;
      font-size: 20px;
      border-radius: 10px;
      border: 1px solid #ccc;
      text-align: center;
      font-family: "Amiri", serif;
    }

    button {
      padding: 12px 30px;
      font-size: 18px;
      cursor: pointer;
      border-radius: 10px;
      border: none;
      background: #1a237e;
      color: white;
      margin-top: 10px;
    }

    canvas {
      margin-top: 25px;
      max-width: 100%;
      border-radius: 15px;
      display: none;
    }

    #downloadBtn {
      display: none;
      background: green;
    }
  </style>
</head>

<body>

  <h2>ðŸŒ™ Ø§ØµÙ†Ø¹ Ø¨Ø·Ø§Ù‚Ø© Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ</h2>

  <!-- Ø®Ø§Ù†Ø© Ø§Ù„Ø§Ø³Ù… -->
  <input id="name" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">

  <!-- Ø®Ø§Ù†Ø© Ø§Ù„Ø¯Ø¹Ø§Ø¡ -->
  <textarea id="dua" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø¯Ø¹Ø§Ø¡ Ù‡Ù†Ø§"></textarea>

  <br>

  <!-- Ø²Ø± Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© -->
  <button onclick="generateCard()">Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</button>

  <!-- Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© -->
  <canvas id="cardCanvas" width="1080" height="1080"></canvas>

  <br>

  <!-- Ø²Ø± ØªØ­Ù…ÙŠÙ„ -->
  <button id="downloadBtn" onclick="downloadCard()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</button>

  <script>
    // âœ… Ø¯Ø§Ù„Ø© Ø°ÙƒÙŠØ© ØªØ¬Ø¹Ù„ Ø§Ù„Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø·ÙˆÙŠÙ„ ÙŠØ¯Ø®Ù„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
    function drawFittedText(ctx, text, x, y, maxWidth, maxHeight) {

      let fontSize = 48; // Ø­Ø¬Ù… Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
      ctx.textAlign = "center";
      ctx.fillStyle = "white";

      while (fontSize > 20) {

        ctx.font = fontSize + 'px "Amiri", serif';

        let words = text.split(" ");
        let line = "";
        let lines = [];

        // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø£Ø³Ø·Ø±
        for (let i = 0; i < words.length; i++) {
          let testLine = line + words[i] + " ";
          let metrics = ctx.measureText(testLine);

          if (metrics.width > maxWidth && i > 0) {
            lines.push(line);
            line = words[i] + " ";
          } else {
            line = testLine;
          }
        }
        lines.push(line);

        // âœ… Ø¥Ø°Ø§ Ø§Ù„Ù†Øµ Ø¯Ø®Ù„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ù†Ø±Ø³Ù…Ù‡
        if (lines.length * (fontSize + 10) <= maxHeight) {

          for (let j = 0; j < lines.length; j++) {
            ctx.fillText(lines[j], x, y + j * (fontSize + 10));
          }
          return;
        }

        // ØªØµØºÙŠØ± Ø§Ù„Ø®Ø· ØªØ¯Ø±ÙŠØ¬ÙŠÙ‹Ø§ Ø¥Ø°Ø§ Ø§Ù„Ù†Øµ Ø·ÙˆÙŠÙ„
        fontSize -= 2;
      }
    }

    // âœ… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
    function generateCard() {

      const name = document.getElementById("name").value;
      const dua = document.getElementById("dua").value;

      const canvas = document.getElementById("cardCanvas");
      const ctx = canvas.getContext("2d");

      // âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ù„Ø¨ (Ø¹Ù†Ø¯Ùƒ Ø§Ø³Ù…Ù‡ bg.jpg)
      const img = new Image();
      img.src = "bg.jpg";

      img.onload = function () {

        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
        canvas.style.display = "block";

        // Ø±Ø³Ù… Ø§Ù„Ø®Ù„ÙÙŠØ©
        ctx.drawImage(img, 0, 0);

        // ----------------------------------------
        // ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… ØªØ­Øª "Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…"
        // ----------------------------------------
        ctx.font = 'bold 50px "Amiri", serif';
        ctx.fillStyle = "white";
        ctx.textAlign = "center";
        ctx.fillText(name, 540, 290);

        // ----------------------------------------
        // ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¯Ø¹Ø§Ø¡ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø¨Ø´ÙƒÙ„ Ù…Ø±ØªØ¨ Ù…Ù‡Ù…Ø§ ÙƒØ§Ù† Ø·ÙˆÙŠÙ„
        // ----------------------------------------
        drawFittedText(
          ctx,
          dua,
          540,   // Ù…Ù†ØªØµÙ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„
          420,   // Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù†Øµ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„
          700,   // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„
          280    // Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„
        );

        // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
        document.getElementById("downloadBtn").style.display = "inline-block";
      };
    }

    // âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© PNG
    function downloadCard() {

      const canvas = document.getElementById("cardCanvas");
      const link = document.createElement("a");

      link.download = "RamadanCard.png";
      link.href = canvas.toDataURL("image/png");
      link.click();
    }
  </script>

</body>
</html>